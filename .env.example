# ============================================
# BioStar Logs Monitor - Configuración
# SEGURIDAD NIVEL GOBIERNO
# ============================================
# IMPORTANTE: Copiar este archivo como .env y configurar valores reales
# NUNCA subir el archivo .env a git (ya está en .gitignore)

# ============================================
# BioStar 2 API Configuration
# ============================================
BIOSTAR_HOST=https://tu-servidor-biostar
BIOSTAR_USER=tu_usuario
BIOSTAR_PASSWORD=tu_password_seguro

# ============================================
# SEGURIDAD - CRÍTICO
# ============================================
# Generar con: python -c "import secrets; print(secrets.token_hex(32))"
SECRET_KEY=CAMBIAR_POR_CLAVE_SEGURA_DE_64_CARACTERES

# Entorno: development | production
FLASK_ENV=production

# ============================================
# Configuración de Sesiones
# ============================================
# Tiempo de vida de sesión en minutos (gobierno: 30)
SESSION_LIFETIME_MINUTES=30

# Timeout de inactividad en minutos (gobierno: 15)
SESSION_INACTIVITY_TIMEOUT=15

# Sesión permanente (recordarme) en días (gobierno: 1)
REMEMBER_COOKIE_DAYS=1

# Validar fingerprint de sesión IP+UserAgent (gobierno: true)
SESSION_FINGERPRINT=true

# ============================================
# Rate Limiting (Protección contra fuerza bruta)
# ============================================
# Intentos de login permitidos por minuto
LOGIN_RATE_LIMIT=5

# Intentos de login antes de bloqueo temporal
LOGIN_MAX_ATTEMPTS=5

# Tiempo de bloqueo en minutos después de exceder intentos
LOGIN_LOCKOUT_MINUTES=15

# Bloqueo PERMANENTE después de X lockouts temporales
PERMANENT_LOCKOUT_AFTER=3

# Rate limit para API (requests por minuto)
API_RATE_LIMIT=60

# ============================================
# Política de Contraseñas (NIVEL GOBIERNO)
# ============================================
# Longitud mínima de contraseña (gobierno: 12)
PASSWORD_MIN_LENGTH=12

# Requerir mayúsculas (true/false)
PASSWORD_REQUIRE_UPPER=true

# Requerir minúsculas (true/false)
PASSWORD_REQUIRE_LOWER=true

# Requerir números (true/false)
PASSWORD_REQUIRE_DIGIT=true

# Requerir caracteres especiales (gobierno: true)
PASSWORD_REQUIRE_SPECIAL=true

# Historial de contraseñas - no reusar últimas N (gobierno: 5)
PASSWORD_HISTORY_COUNT=5

# Expiración de contraseña en días (gobierno: 90)
PASSWORD_MAX_AGE_DAYS=90

# ============================================
# 2FA - Autenticación de Dos Factores
# ============================================
# Requerir 2FA para todos los usuarios
REQUIRE_2FA=false

# Requerir 2FA solo para administradores (gobierno: true)
REQUIRE_2FA_FOR_ADMIN=true

# ============================================
# IP Whitelisting
# ============================================
# Habilitar whitelist de IPs (gobierno: true para producción)
IP_WHITELIST_ENABLED=false

# IPs permitidas (separadas por coma)
# IP_WHITELIST=192.168.1.1,10.0.0.1

# IPs permitidas solo para administradores
# ADMIN_IP_WHITELIST=192.168.1.100

# ============================================
# CSRF Protection
# ============================================
CSRF_ENABLED=true
CSRF_TIME_LIMIT=3600

# ============================================
# Logging y Auditoría
# ============================================
LOG_LEVEL=INFO

# Habilitar log de auditoría de seguridad
SECURITY_AUDIT_LOG=true

# Archivo de log de auditoría
AUDIT_LOG_FILE=logs/security_audit.log

# Log de TODAS las peticiones (gobierno: true)
AUDIT_ALL_REQUESTS=false

# ============================================
# Encriptación de Datos
# ============================================
# Encriptar datos sensibles en BD
ENCRYPT_SENSITIVE_DATA=true

# Clave de encriptación (generar con: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())")
# ENCRYPTION_KEY=

# ============================================
# Configuración de Base de Datos
# ============================================
# Para producción, considera usar PostgreSQL
# DATABASE_URL=postgresql://user:pass@localhost/biostar_logs
DATABASE_URL=sqlite:///biostar_users.db

# ============================================
# HTTPS (Producción - OBLIGATORIO)
# ============================================
# Forzar HTTPS en producción (gobierno: true)
FORCE_HTTPS=false

# Tiempo de HSTS en segundos (1 año)
HSTS_MAX_AGE=31536000

# ============================================
# Configuración de Red
# ============================================
# Puerto del servidor (default: 5000)
PORT=5000

# Host (0.0.0.0 para acceso externo)
HOST=127.0.0.1

# Modo debug (NUNCA true en producción)
DEBUG=false

# ============================================
# Admin por Defecto
# ============================================
# Contraseña inicial del admin (si no se especifica, se genera automáticamente)
# ADMIN_DEFAULT_PASSWORD=

# ============================================
# Producción - Ocultar Información Sensible
# ============================================
# Ocultar versión del servidor en headers
HIDE_SERVER_INFO=true

# Suprimir console.log en navegador (producción)
SUPPRESS_CONSOLE_LOGS=true

# Remover comentarios HTML
REMOVE_COMMENTS=true

# Deshabilitar debug toolbar
DISABLE_DEBUG_TOOLBAR=true
